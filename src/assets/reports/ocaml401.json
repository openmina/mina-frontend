{"filename":"src/lib/rosetta_lib/memoize.ml","lines":[{"line":"open Core_kernel","counters":[]},{"line":"open Async_kernel","counters":[]},{"line":"","counters":[]},{"line":"let ignores_args : ('a -> 'b) -> 'a -> 'b =","counters":[]},{"line":" fun f ->","counters":[]},{"line":"  let cached : 'b option ref = ref None in","counters":[{"col_start":2,"col_end":2,"count":0}]},{"line":"  match !cached with","counters":[]},{"line":"  | None ->","counters":[{"col_start":4,"col_end":4,"count":0}]},{"line":"      fun a ->","counters":[]},{"line":"        let b = f a in","counters":[{"col_start":8,"col_end":8,"count":0}]},{"line":"        cached := Some b ;","counters":[{"col_start":8,"col_end":8,"count":0}]},{"line":"        b","counters":[]},{"line":"  | Some b ->","counters":[{"col_start":4,"col_end":4,"count":0}]},{"line":"      fun _a -> b","counters":[{"col_start":16,"col_end":16,"count":0}]},{"line":"","counters":[]},{"line":"let build :","counters":[]},{"line":"       (graphql_uri:Uri.t -> unit -> ('gql, 'e) Deferred.Result.t)","counters":[]},{"line":"    -> graphql_uri:Uri.t","counters":[]},{"line":"    -> unit","counters":[]},{"line":"    -> ('gql, 'e) Deferred.Result.t =","counters":[]},{"line":" fun f ->","counters":[]},{"line":"  let open Deferred.Result.Let_syntax in","counters":[{"col_start":2,"col_end":2,"count":0}]},{"line":"  let cached_response : 'gql option ref = ref None in","counters":[]},{"line":"  fun ~graphql_uri () ->","counters":[]},{"line":"    match !cached_response with","counters":[{"col_start":4,"col_end":4,"count":0}]},{"line":"    | None ->","counters":[{"col_start":6,"col_end":6,"count":0}]},{"line":"        let%map r = f ~graphql_uri () in","counters":[{"col_start":20,"col_end":20,"count":0}]},{"line":"        cached_response := Some r ;","counters":[{"col_start":8,"col_end":8,"count":0}]},{"line":"        r","counters":[]},{"line":"    | Some r ->","counters":[{"col_start":6,"col_end":6,"count":0}]},{"line":"        Deferred.Result.return r","counters":[{"col_start":31,"col_end":31,"count":1}]}]}