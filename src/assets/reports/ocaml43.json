{"filename":"src/lib/gossip_net/message.ml","lines":[{"line":"open Async","counters":[]},{"line":"open Core_kernel","counters":[]},{"line":"open Network_pool","counters":[]},{"line":"open Network_peer","counters":[]},{"line":"","counters":[]},{"line":"module Master = struct","counters":[]},{"line":"  module T = struct","counters":[]},{"line":"    type msg =","counters":[{"col_start":4,"col_end":4,"count":0}]},{"line":"      | New_state of Mina_block.t","counters":[{"col_start":6,"col_end":6,"count":0},{"col_start":21,"col_end":21,"count":0},{"col_start":32,"col_end":32,"count":0}]},{"line":"      | Snark_pool_diff of Snark_pool.Resource_pool.Diff.t","counters":[{"col_start":6,"col_end":6,"count":0},{"col_start":27,"col_end":27,"count":0},{"col_start":57,"col_end":57,"count":0}]},{"line":"      | Transaction_pool_diff of Transaction_pool.Resource_pool.Diff.t","counters":[{"col_start":6,"col_end":6,"count":0},{"col_start":33,"col_end":33,"count":0},{"col_start":69,"col_end":69,"count":0}]},{"line":"    [@@deriving sexp, to_yojson]","counters":[]},{"line":"","counters":[]},{"line":"    type state_msg = Mina_block.t","counters":[]},{"line":"","counters":[]},{"line":"    type snark_pool_diff_msg = Snark_pool.Resource_pool.Diff.t","counters":[]},{"line":"","counters":[]},{"line":"    type transaction_pool_diff_msg = Transaction_pool.Resource_pool.Diff.t","counters":[]},{"line":"  end","counters":[]},{"line":"","counters":[]},{"line":"  let name = \"message\"","counters":[]},{"line":"","counters":[]},{"line":"  module Caller = T","counters":[]},{"line":"  module Callee = T","counters":[]},{"line":"end","counters":[]},{"line":"","counters":[]},{"line":"include Master.T","counters":[]},{"line":"include Versioned_rpc.Both_convert.One_way.Make (Master)","counters":[]},{"line":"","counters":[]},{"line":"module V2 = struct","counters":[]},{"line":"  module T = struct","counters":[]},{"line":"    type msg =","counters":[{"col_start":4,"col_end":4,"count":1},{"col_start":11,"col_end":11,"count":2}]},{"line":"      | New_state of Mina_block.Stable.V2.t","counters":[{"col_start":6,"col_end":6,"count":0}]},{"line":"      | Snark_pool_diff of Snark_pool.Diff_versioned.Stable.V2.t","counters":[{"col_start":6,"col_end":6,"count":0}]},{"line":"      | Transaction_pool_diff of Transaction_pool.Diff_versioned.Stable.V2.t","counters":[{"col_start":6,"col_end":6,"count":0}]},{"line":"    [@@deriving bin_io, sexp, version { rpc }]","counters":[{"col_start":45,"col_end":45,"count":4}]},{"line":"","counters":[]},{"line":"    type state_msg = Mina_block.Stable.V2.t","counters":[]},{"line":"","counters":[]},{"line":"    type snark_pool_diff_msg = Snark_pool.Diff_versioned.Stable.V2.t","counters":[]},{"line":"","counters":[]},{"line":"    type transaction_pool_diff_msg = Transaction_pool.Diff_versioned.Stable.V2.t","counters":[]},{"line":"","counters":[]},{"line":"    let callee_model_of_msg msg =","counters":[]},{"line":"      match msg with","counters":[{"col_start":6,"col_end":6,"count":0}]},{"line":"      | New_state state ->","counters":[{"col_start":8,"col_end":8,"count":0}]},{"line":"          Master.T.New_state state","counters":[]},{"line":"      | Snark_pool_diff diff ->","counters":[{"col_start":8,"col_end":8,"count":0}]},{"line":"          Master.T.Snark_pool_diff diff","counters":[]},{"line":"      | Transaction_pool_diff diff ->","counters":[{"col_start":8,"col_end":8,"count":0}]},{"line":"          Master.T.Transaction_pool_diff diff","counters":[]},{"line":"","counters":[]},{"line":"    let msg_of_caller_model msg =","counters":[]},{"line":"      match msg with","counters":[{"col_start":6,"col_end":6,"count":0}]},{"line":"      | Master.T.New_state state ->","counters":[{"col_start":8,"col_end":8,"count":0}]},{"line":"          New_state state","counters":[]},{"line":"      | Master.T.Snark_pool_diff diff ->","counters":[{"col_start":8,"col_end":8,"count":0}]},{"line":"          Snark_pool_diff diff","counters":[]},{"line":"      | Master.T.Transaction_pool_diff diff ->","counters":[{"col_start":8,"col_end":8,"count":0}]},{"line":"          Transaction_pool_diff diff","counters":[]},{"line":"  end","counters":[]},{"line":"","counters":[]},{"line":"  include Register (T)","counters":[]},{"line":"","counters":[]},{"line":"  let summary = function","counters":[]},{"line":"    | T.New_state _ ->","counters":[{"col_start":6,"col_end":6,"count":0}]},{"line":"        \"new state\"","counters":[]},{"line":"    | Snark_pool_diff _ ->","counters":[{"col_start":6,"col_end":6,"count":0}]},{"line":"        \"snark pool diff\"","counters":[]},{"line":"    | Transaction_pool_diff _ ->","counters":[{"col_start":6,"col_end":6,"count":0}]},{"line":"        \"transaction pool diff\"","counters":[]},{"line":"end","counters":[]},{"line":"","counters":[]},{"line":"module Latest = V2","counters":[]},{"line":"","counters":[]},{"line":"[%%define_locally Latest.(summary)]","counters":[]},{"line":"","counters":[]},{"line":"type block_sink_msg =","counters":[]},{"line":"  [ `Transition of state_msg Envelope.Incoming.t ]","counters":[]},{"line":"  * [ `Time_received of Block_time.t ]","counters":[]},{"line":"  * [ `Valid_cb of Mina_net2.Validation_callback.t ]","counters":[]},{"line":"","counters":[]},{"line":"type tx_sink_msg =","counters":[]},{"line":"  transaction_pool_diff_msg Envelope.Incoming.t","counters":[]},{"line":"  * Mina_net2.Validation_callback.t","counters":[]},{"line":"","counters":[]},{"line":"type snark_sink_msg =","counters":[]},{"line":"  snark_pool_diff_msg Envelope.Incoming.t * Mina_net2.Validation_callback.t","counters":[]},{"line":"","counters":[]},{"line":"type 'msg push_modifier = ('msg -> unit Deferred.t) -> 'msg -> unit Deferred.t","counters":[]},{"line":"","counters":[]},{"line":"module type Sinks_intf = sig","counters":[]},{"line":"  module Block_sink : Mina_net2.Sink.S with type msg := block_sink_msg","counters":[]},{"line":"","counters":[]},{"line":"  module Tx_sink : Mina_net2.Sink.S with type msg := tx_sink_msg","counters":[]},{"line":"","counters":[]},{"line":"  module Snark_sink : Mina_net2.Sink.S with type msg := snark_sink_msg","counters":[]},{"line":"","counters":[]},{"line":"  type t = Block_sink.t * Tx_sink.t * Snark_sink.t","counters":[]},{"line":"end","counters":[]},{"line":"","counters":[]},{"line":"type ('sink_block, 'sink_tx, 'sink_snark) sinks_impl =","counters":[]},{"line":"  (module Sinks_intf","counters":[]},{"line":"     with type Block_sink.t = 'sink_block","counters":[]},{"line":"      and type Snark_sink.t = 'sink_snark","counters":[]},{"line":"      and type Tx_sink.t = 'sink_tx )","counters":[]},{"line":"","counters":[]},{"line":"type sinks = Any_sinks : ('a, 'b, 'c) sinks_impl * ('a * 'b * 'c) -> sinks","counters":[{"col_start":73,"col_end":73,"count":1}]}]}