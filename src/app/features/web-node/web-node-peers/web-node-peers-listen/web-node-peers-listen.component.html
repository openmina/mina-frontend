<div class="h-lg">
  <button class="mt-5 ml-12 fx-row-vert-cent secondary primary-hover bg-transparent"
          routerLink="/web-node/peers">
    <span class="mina-icon f-20 mr-8">arrow_back</span>
    <span>Back to Peers</span>
  </button>
</div>

<div class="flex-column align-center pt-12 flex-grow">
  <mina-stepper [stepHeaders]="['Share ID', 'Receive Offer', 'Generate Answer', 'Send Answer']"
                [steps]="[step1, step2, step3, step4]"
                [activeStep]="activeStep"
                [footerTemplate]="stepperFooter"
                [height]="380"
                [style.max-width.px]="600"></mina-stepper>
</div>

<ng-template #step1>
  <div class="border-rad-6 border p-12 flex-column h-100">
    <ng-container *ngIf="!copiedPeerId; else peerIdCopied">
      <div class="fx-col-full-cent flex-grow">
        <span class="mina-icon icon-100 paste-icon">conversion_path</span>
      </div>
      <div class="bg-container border-rad-4 h-lg fx-row-vert-cent pl-12 pr-12 flex-between text-nowrap overflow-hidden">
        <span>Peer ID</span>
        <span class="monospace">{{ peerId }}</span>
      </div>
      <div class="fx-row-vert-cent tertiary pt-12">
        <span class="mina-icon f-20 mr-5 icon-100">info</span>
        Copy ID and share it with a node you want to connect to and wait for the answer.
      </div>
    </ng-container>
    <ng-template #peerIdCopied>
      <div class="fx-col-full-cent h-100 text-center">
        <span class="help-icon mina-icon mb-16 icon-100">check_circle</span>
        <p>
          Your ID got copied to clipboard, send the ID to a peer via email,
          <br>
          message, ...
        </p>
      </div>
    </ng-template>
  </div>
</ng-template>

<ng-template #step2>
  <div class="border-rad-6 border p-12 flex-column h-100">
    <div class="flex-column flex-grow bg-container border-rad-4 p-12 w-100">
      <div class="f-600 h-sm">Received Offer</div>
      <div class="flex-grow flex-column align-center flex-center tertiary">
        <span class="paste-icon mina-icon mb-5 icon-100">content_paste</span>
        <span>Paste offer here</span>
      </div>
    </div>
    <div class="flex-row tertiary align-center pt-12">
      <span class="mina-icon f-20 mr-5 icon-100">info</span>
      Paste the offer generated by the other node.
    </div>
  </div>
</ng-template>

<ng-template #step3>
  <div class="flex-column flex-grow bg-container border-rad-4 p-12 h-100">
    <div class="f-600 h-md">Received Offer</div>
    <div class="flex-column flex-grow overflow-auto transparent-scrollbar-track">
      <mina-json-viewer [json]="offer" [expanded]="true"></mina-json-viewer>
    </div>
  </div>
  <div class="flex-row tertiary align-center pt-12">
    <span class="mina-icon f-20 mr-5 icon-100">info</span>
    Offer has been received.
  </div>
</ng-template>

<ng-template #step4>
  <div class="border-rad-6 border p-12 flex-column h-100">
    <ng-container *ngIf="!copiedAnswer; else answerCopied">
      <div class="h-50 flex-column bg-container border-rad-4 p-12 w-100 mb-5">
        <div class="f-600 h-sm">Initial Offer</div>
        <div class="flex-column flex-grow overflow-auto transparent-scrollbar-track">
          <mina-json-viewer [json]="offer" [expanded]="true"></mina-json-viewer>
        </div>
      </div>
      <div class="h-50 flex-column bg-container border-rad-4 p-12 w-100">
        <div class="f-600 h-sm">Generated Answer</div>
        <div class="flex-column flex-grow overflow-auto transparent-scrollbar-track">
          <mina-json-viewer [json]="answer" [expanded]="true"></mina-json-viewer>
        </div>
      </div>
    </ng-container>
    <ng-template #answerCopied>
      <div class="fx-col-full-cent h-100 text-center">
        <span class="help-icon mina-icon mb-16 icon-100">check_circle</span>
        <p>
          Generated answer copied to clipboard, send the answer back
          <br>
          to the peer
        </p>
      </div>
    </ng-template>
  </div>
</ng-template>

<ng-template #stepperFooter>
  <div class="flex-row flex-between mt-16">
    <button class="action-btn btn-primary pl-12 pr-12 h-md" (click)="prevStep()"
            [disabled]="activeStep === 0">Back</button>
    <button class="action-btn btn-selected pl-12 pr-12 h-md" (click)="nextStep()">
      {{ activeStep === 0
      ? !copiedPeerId ? 'Copy ID to Clipboard' : 'Continue'
      : activeStep === 1
        ? 'Paste Offer from Clipboard'
        : activeStep === 2
          ? 'Generate Answer'
          : activeStep === 3 && !copiedAnswer ? 'Copy Answer to Clipboard' : 'Done' }}
    </button>
  </div>
</ng-template>
