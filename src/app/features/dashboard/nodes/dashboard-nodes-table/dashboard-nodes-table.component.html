<div *ngIf="!currentHeightIsTooBig; else mismatch" class="mina-table flex-grow overflow-x-auto">
  <div class="row head sorting p-relative pr-12" *ngIf="currentSort">
    <span *ngFor="let tableHead of tableHeads; let i=index"
          (click)="sortTable(tableHead.sort ?? tableHead.name)"
          [class.active]="currentSort.sortBy === (tableHead.sort ?? tableHead.name)"
          class="pointer">
      {{ tableHead.name }}
      <span [class.flip]="currentSort.sortDirection === 'descending'"
            [class.show]="currentSort.sortBy === (tableHead.sort ?? tableHead.name)"
            class="mina-icon f-18 icon-200">arrow_upward
      </span>
    </span>
  </div>
  <cdk-virtual-scroll-viewport class="border-bottom border-top h-100 overflow-y-scroll h-minus-lg"
                               [itemSize]="itemSize">
    <div *cdkVirtualFor="let node of nodes; let i=index"
         (click)="onRowClick(node)"
         [class.active]="activeNode?.index === node.index"
         [class.row-even]="i % 2 === 0"
         class="row">
      <span>
        <a [href]="node.url" target="_blank" class="underline secondary">{{ node.name }}</a>
      </span>
      <span>
        <span class="status f-600" [ngClass]="node.status.toLowerCase()">{{ node.status }}</span>
      </span>
      <span>
        <mina-copy [value]="node.hash" [display]="node.hash || '-' | truncateMid"></mina-copy>
      </span>
      <span>{{ node.blockchainLength || '-' }}</span>
      <span>{{ node.addr || '-' }}</span>
      <span>{{ node.date || '-' }}</span>
      <span [innerHTML]="node.latency | secDuration: secConfig"></span>
      <span [innerHTML]="node.blockApplication | secDuration: secConfig"></span>
      <span>{{ node.source || '-' }}</span>
      <span [ngClass]="node.traceStatus">{{ node.traceStatus || '-' }}</span>
      <span [tooltip]="node.addedTx + ' added, ' + node.broadcastedTx + ' broadcasted, ' + node.receivedTx + ' received'">{{ node.txPool ?? '-' }}</span>
      <span [tooltip]="node.snarkDiffBroadcasted + ' broadcasted, ' + node.snarkDiffReceived + ' received, ' + node.pendingSnarkWork + ' pending snark work'">{{ node.snarkPool ?? '-' }}</span>
      <span class="fx-row-vert-cent">
        <button class="btn-primary fx-row-full-cent primary-hover"
                [disabled]="downloadingNodes.includes(i)"
                (click)="downloadLogs(node, i, $event)">
          <span class="mina-icon icon-200 f-20">{{ downloadingNodes.includes(i) ? 'more_horiz' : 'download' }}</span>
        </button>
      </span>
    </div>
  </cdk-virtual-scroll-viewport>
</div>
<ng-template #mismatch>
  <div class="no-results p-absolute w-100 h-100 z-1 fx-col-full-cent">
    <span class="mina-icon mb-16 icon-100 f-40">error</span>
    <span class="f-600 f-big">No results</span>
    <span class="tertiary mt-8 text-center">
      The current selected height is bigger than the biggest height in the network.
    </span>
    <button class="btn-selected fx-row-vert-cent pl-12 pr-12 mt-16 h-lg"
            (click)="setActiveBlock()">
      <span class="mr-5 mina-icon icon-200 f-20">arrow_right_alt</span>
      See latest height ({{ latestHeight }})
    </button>
  </div>
</ng-template>
