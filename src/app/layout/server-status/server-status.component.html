<div class="debugger-status h-24 ml-8 border-rad-4 flex-row align-center"
     *ngIf="enabledDebugger && debuggerStatus"
     [tooltip]="debuggerTooltip"
     [class.failed]="debuggerStatus.failed"
     [class.offline]="!debuggerStatus.isOnline">
  <span class="mina-icon icon-200 f-20">code</span>
  <span *ngIf="debuggerStatus.failed !== undefined" class="ml-5 mr-5">{{ debuggerStatus.failed | number: '1.1-1' }}%
                                                                                                                   Failed
  </span>
  <div *ngIf="!debuggerStatus.isOnline" class="ml-5 mr-5">Offline</div>
</div>

<div class="web-node-status h-24 ml-8 border-rad-4 flex-row align-center"
     *ngIf="enabledWebNode && webNodeStatus"
     [tooltip]="webNodeTooltip"
     [class.offline]="!webNodeStatus.peers && !webNodeStatus.messages">
  <span class="mina-icon icon-300 f-20">language</span>
  <div class="ml-5 mr-5">
    {{ webNodeStatus.peers }} peer{{ webNodeStatus.peers === 1 ? '' : 's' }} , {{ webNodeStatus.messages }} message{{ webNodeStatus.messages === 1 ? '' : 's' }}
  </div>
</div>

<div class="node-status ml-8 mr-8 border-rad-4 p-relative overflow-hidden">
  <div *ngIf="status === 'catchup' || status === 'bootstrap'"
       class="shining-border p-absolute overflow-hidden"></div>
  <div class="bg-surface border-rad-4">
    <div class="background-wrap border-rad-4 flex-row align-center"
         [ngClass]="status">
      <div class="block-level h-24 flex-row align-center pl-5 pr-8"
           [tooltip]="nodeTooltip">
        <span class="strong-text text-capitalize flex-row align-center mr-5">
          <span class="mina-icon icon-200 f-20">dns</span>
          &nbsp;{{ status }}
        </span>
        <span class="p-relative" *ngIf="timeIsPresent && !isMobile">
          <span *ngIf="blockLevel > 0">#{{ blockLevel }}&nbsp;</span>
          <span class="p-absolute text-light" [innerHTML]="elapsedTime$ | async"></span>
          <span class="p-absolute ago">ago</span>
        </span>
      </div>
      <div class="node-switcher pointer h-24 flex-row align-center pl-5 pr-8"
           #overlayOpener (click)="openNodePicker($event)">
        <span class="strong-text">{{ activeNode?.name }}</span>
        <span class="mina-icon icon-200">arrow_drop_down</span>
      </div>
    </div>
  </div>
</div>

<ng-template #nodePicker>
  <div class="flex-column border border-rad-4 bg-surface-top w-100 pointer p-5"
       (clickOutside)="detachOverlay()">
    <div *ngFor="let node of nodes; let i=index"
         (click)="selectNode(node)"
         [ngClass]="{
          'selected-primary bg-selected-container': activeNode === node,
          'secondary bg-container-hover primary-hover': activeNode !== node,
          'mb-5': i < nodes.length - 1
          }"
         class="h-40 pl-12 pr-12 flex-row flex-between border-rad-4">
      <span class="mina-icon icon-200 f-20 divider mr-8"
            [class.selected-primary]="activeNode === node">check
      </span>
      <div class="flex-column w-100">
        <span fxFlex="45" class="flex-row align-end">{{ node.name }}</span>
        <span fxFlex="55" class="flex-row align-center"
              [ngClass]="activeNode === node ? 'selected-secondary' : 'tertiary'">{{ node.backend }}</span>
      </div>
    </div>
  </div>
</ng-template>
